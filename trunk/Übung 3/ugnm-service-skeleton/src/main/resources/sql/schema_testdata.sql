DROP TABLE IF EXISTS USER;
DROP TABLE IF EXISTS MEDIUM;
DROP TABLE IF EXISTS ACHIEVEMENT;
DROP TABLE IF EXISTS RATES;
DROP TABLE IF EXISTS ACHIEVES;

CREATE TABLE MEDIUM (
  ID int(11) NOT NULL auto_increment,
  URL char(255) NOT NULL,
  DESCRIPTION text NOT NULL,
  CONSTRAINT MEDIUM_PK PRIMARY KEY  (ID),
  CONSTRAINT MEDIUM_UK UNIQUE KEY (URL)
);

CREATE TABLE USER (
	ID int(11) NOT NULL auto_increment,
	NAME char(255) NOT NULL,
	XP int(11) NOT NULL default 0,
	CONSTRAINT USER_PK PRIMARY KEY (ID),
	CONSTRAINT USER_UK UNIQUE KEY (NAME),
	CONSTRAINT USER_XP_C CHECK (XP >= 0)
); 

CREATE TABLE ACHIEVEMENT (
	ID int(11) NOT NULL auto_increment,
	NAME char(255) NOT NULL,
	IMGURL char(255) NOT NULL,
	CONSTRAINT ACHIEVEMENT_PK PRIMARY KEY (ID),
	CONSTRAINT ACHIEVEMENT_UK UNIQUE KEY (NAME)
);

CREATE TABLE RATES (
	USER int(11) NOT NULL,
	MEDIUM int(11) NOT NULL,
	RATING int(1) NOT NULL,
	TIME timestamp NOT NULL,
	CONSTRAINT RATES_PK PRIMARY KEY (USER,MEDIUM,TIME),
	CONSTRAINT RUSER_FK FOREIGN KEY (USER) REFERENCES USER (ID),
	CONSTRAINT MEDIUM_FK FOREIGN KEY (MEDIUM) REFERENCES MEDIUM (ID),
	CONSTRAINT RATES_RATING_C CHECK (RATING >= 0 AND RATING <=1)
); 

CREATE TABLE ACHIEVES (
	USER int(11) NOT NULL,
	ACHIEVEMENT int(11) NOT NULL,
	TIME timestamp NOT NULL,
	CONSTRAINT ACHIEVES_PK PRIMARY KEY (USER,ACHIEVEMENT),
	CONSTRAINT AUSER_FK FOREIGN KEY (USER) REFERENCES USER (ID),
	CONSTRAINT ACHIEVEMENT_FK FOREIGN KEY (ACHIEVEMENT) REFERENCES ACHIEVEMENT (ID)
); 

INSERT INTO MEDIUM VALUES (1,'http://static.prisonplanet.com/p/images/may2011/020511top.jpg','Der Osama bin Liggedi');
INSERT INTO MEDIUM VALUES (2,'http://udssr.net/wp-content/uploads/2010/03/wolfram-goldbarren-faelschung_01_hq.jpg','Jefaelschte Joltbarren');

INSERT INTO USER VALUES (1,'Dominik Renzel',100);
INSERT INTO USER VALUES (2,'Ralf Klamma',1000);
INSERT INTO USER VALUES (3,'President Evil',10000);

INSERT INTO ACHIEVEMENT VALUES (1,'Henkerorden','http://1.bp.blogspot.com/-VYNG6hCyGV8/Tghv_YMhTsI/AAAAAAAAAjY/iSE20voVSK0/s400/henker.jpg');
INSERT INTO ACHIEVEMENT VALUES (2,'Sauforden','http://www.verschoett.de/assets/images/autogen/a_502.jpg');
INSERT INTO ACHIEVEMENT VALUES (3,'Hundeorden','http://bild0.qimage.de/hundeverein-1-freizeithundeverein-foto-bild-36349790.270.jpg');

INSERT INTO RATES VALUES (1,1,1,NOW());
INSERT INTO RATES VALUES (1,2,1,NOW());
INSERT INTO RATES VALUES (2,1,1,NOW());
INSERT INTO RATES VALUES (2,2,0,NOW());
INSERT INTO RATES VALUES (3,1,1,NOW());
INSERT INTO RATES VALUES (3,2,0,NOW());

INSERT INTO ACHIEVES VALUES (1,1,NOW());
INSERT INTO ACHIEVES VALUES (1,2,NOW());
INSERT INTO ACHIEVES VALUES (2,2,NOW());
INSERT INTO ACHIEVES VALUES (2,3,NOW());
INSERT INTO ACHIEVES VALUES (3,1,NOW());
INSERT INTO ACHIEVES VALUES (3,2,NOW());


